---
import Layout from '../layouts/Layout.astro';
import Feed from '../components/Feed';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('posts');
const posts = allPosts
  .map(post => ({
    slug: post.slug,
    title: post.data.title,
    date: post.data.date,
    tags: post.data.tags,
    tagline: post.data.tagline,
  }))
  .sort((a, b) => (a.date < b.date ? 1 : -1));
---

<Layout>
  <div class="max-w-4xl mx-auto p-8">
      <h1 class="text-4xl font-bold mb-8">Recent Posts</h1>
      {posts.length > 0 ? (
        <Feed posts={posts} client:load />
        ) : (
        <div>
            <p class="text-secondary text-lg font-mono mb-4">
                you've found me at a very 'i have no blog posts yet' time in my life
            </p>
            <p class="text-secondary text-sm font-mono">
                check back soon...
            </p>
        </div>
      )}
  </div>
</Layout>
